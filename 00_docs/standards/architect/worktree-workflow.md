# Workflow с Git Worktree

Правила использования git worktree для параллельной работы в проекте.

## Когда использовать worktree

### ✅ Используй worktree для:

**1. Параллельных задач**
- Задача 001 на review, начинаем 002
- Несколько независимых фич одновременно
- Срочный hotfix во время разработки feature

**2. Экспериментов**
- Проверка гипотез без влияния на основную разработку
- Сравнение разных подходов к реализации
- Тестирование архитектурных решений

**3. Альтернативных архитектурных решений**
- Экспериментальные ADR
- Proof of concept для новых паттернов
- Тестирование разных технологий/библиотек

**4. Изолированных изменений**
- Рефакторинг требующий отдельного контекста
- Изменения затрагивающие много файлов
- Работа требующая особой концентрации

### ❌ НЕ используй worktree для:

- Последовательной работы (работай в main)
- Мелких правок (commit в текущую ветку)
- "На всякий случай" без конкретной цели

## Naming conventions

**Правило:** Имя папки worktree = имя ветки

**Примеры:**
- `.worktrees/task-002` на ветке `task-002`
- `.worktrees/experiment` на ветке `experiment`
- `.worktrees/refactor-api` на ветке `refactor-api`

## Создание worktree

**Architect создает через skill:**
```
Создай worktree для [название/цель]
```

**Skill:**
1. Проверяет git status
2. Спрашивает о коммите если есть незакоммиченные изменения
3. Спрашивает имя ветки/папки
4. Создает worktree: `git worktree add .worktrees/название`

**После создания** - работа в worktree идет как обычно через роли:
- Analyst → Developer → Reviewer
- Коммиты в свою ветку worktree

## Работа с worktree

**Список активных worktree:**
```bash
git worktree list
```

**Переключение между worktree:**
```bash
cd .worktrees/experiment  # Работа в worktree
cd ../..                  # Возврат в main
cd .worktrees/task-002    # Другой worktree
```

## Архитектурные решения в worktree

**Экспериментальный ADR:**
- Создай ADR в worktree
- После merge попадет в main
- Другие worktree подтянут через `git merge main`

**ADR для нескольких worktree:**
- Создай ADR сразу в main
- Все worktree подтянут через `git merge main`

## После завершения работы

Пользователь самостоятельно выполняет:
- Merge ветки в main
- Удаление worktree
- Удаление ветки

Через стандартные git команды.
